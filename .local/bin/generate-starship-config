#!/bin/bash
# Generate starship config based on system theme

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
DOTFILES_DIR="$(cd "$SCRIPT_DIR/../.." && pwd)"
THEME=$(bash "$SCRIPT_DIR/detect-system-theme")
CONFIG_FILE="$HOME/.config/starship.toml"
TEMPLATE_FILE="$DOTFILES_DIR/.config/catppuccin-powerline.toml"

if [[ "$THEME" == "light" ]]; then
    PALETTE="catppuccin_latte"
else
    PALETTE="catppuccin_macchiato"
fi

# Copy the official template and replace the palette
sed "s/^palette = .*/palette = '$PALETTE'/" "$TEMPLATE_FILE" > "$CONFIG_FILE"

export STARSHIP_CONFIG="$CONFIG_FILE"
